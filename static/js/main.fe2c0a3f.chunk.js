(this["webpackJsonpmegaten-fusion-calculator"]=this["webpackJsonpmegaten-fusion-calculator"]||[]).push([[0],{128:function(e,n,t){},129:function(e,n,t){"use strict";t.r(n);var i=t(5),a=t(0),r=t.n(a),s=t(13),o=t.n(s),c=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,184)).then((function(n){var t=n.getCLS,i=n.getFID,a=n.getFCP,r=n.getLCP,s=n.getTTFB;t(e),i(e),a(e),r(e),s(e)}))},l=t(9),u=t(98),d=t(180),m=t(181),h=t(18),f=t(27),v=t(39),b=function e(n,t,i,a,r){Object(f.a)(this,e),this.id=0,this.name=void 0,this.lvl=void 0,this.race=void 0,this.rank=0,this.uniqueRecipe=!1,this.stats=[],this.id=n,this.name=t,this.lvl=i,this.race=a,this.stats=r};b.statsName=[];var j=function(){function e(n,t,i){Object(f.a)(this,e),this.demon=void 0,this.ingredientA=void 0,this.ingredientB=void 0,this.demon=n,this.ingredientA=t,this.ingredientB=i}return Object(v.a)(e,[{key:"isFused",value:function(){return void 0!==this.ingredientA&&void 0!==this.ingredientB}},{key:"toRecipeString",value:function(){var e="",n=" | ";if(this.ingredientA&&this.ingredientB){var t=this.ingredientA.toRecipeString();t&&(e&&(e+=n),e+=t);var i=this.ingredientB.toRecipeString();i&&(e&&(e+=n),e+=i),e&&(e+=n),e+=this.ingredientA.demon.name+" + "+this.ingredientB.demon.name+" = "+this.demon.name}return e}},{key:"toBaseIngredientSearchString",value:function(){var e="";return this.ingredientA&&this.ingredientB?(e+=this.ingredientA.toBaseIngredientSearchString(),e+=this.ingredientB.toBaseIngredientSearchString()):this.demon.name}},{key:"isWeakerThanIngredients",value:function(){return this.demon.lvl<this.getHighestIngredientLvl()}},{key:"getHighestIngredientLvl",value:function(){var e=0;if(this.ingredientA&&this.ingredientB){var n=this.ingredientA.getHighestIngredientLvl();n>e&&(e=n);var t=this.ingredientB.getHighestIngredientLvl();return t>e&&(e=t),e}return this.demon.lvl}}]),e}(),g=function e(n,t){Object(f.a)(this,e),this.caption="",this.demons=[],this.caption=n,this.demons=t},p="Element",O=function(){function e(n,t,i){Object(f.a)(this,e),this.demonJson=void 0,this.fusionChartJson=void 0,this.presetJson=void 0,this.demonAry=[],this.raceFusionTable={},this.demonsPresets=[],this.idMap={},this.nameMap={},this.raceLvlDemonMap={},this.demonJson=n,this.fusionChartJson=t,this.presetJson=i,this.parseDemons(),this.prepDemonIds(),this.parseRaceFusionTable(),this.prepRaceLvlInfo(),this.parsePresets()}return Object(v.a)(e,[{key:"getDemonById",value:function(e){return this.idMap[e]}},{key:"getDemonByName",value:function(e){return this.nameMap[e]}},{key:"getDemonArray",value:function(){return this.demonAry}},{key:"getDemonPresets",value:function(){return this.demonsPresets}},{key:"fuseDemons",value:function(e,n){return e.race===p&&n.race===p?void 0:e.race===p||n.race===p?this.fuseDemonWithElement(e,n):e.race===n.race?this.fuseDemonSameRaceNoEle(e,n):this.fuseDemonDiffRaceNoEle(e,n)}},{key:"testGetRandomDemon",value:function(){if(0!==this.demonAry.length){var e=Math.floor(Math.random()*this.demonAry.length);return this.demonAry[e]}}},{key:"testGetRandomElement",value:function(){if(0!==this.fusionChartJson.elements.length){var e=Math.floor(Math.random()*this.fusionChartJson.elements.length);return this.getDemonByName(this.fusionChartJson.elements[e])}}},{key:"parseDemons",value:function(){b.statsName=this.demonJson.statsName;var e=this.demonJson.demons;for(var n in e){var t=e[n];this.demonAry.push(new b(0,n,t.lvl,t.race,t.stats))}}},{key:"parseRaceFusionTable",value:function(){for(var e=0;e<this.fusionChartJson.raceFusionTable.length;e++)for(var n=0;n<this.fusionChartJson.raceFusionTable[e].length;n++){var t=this.fusionChartJson.races[e],i=this.fusionChartJson.races[n],a=this.fusionChartJson.raceFusionTable[e][n];this.raceFusionTable[t]||(this.raceFusionTable[t]={}),this.raceFusionTable[t][i]=a,this.raceFusionTable[i]||(this.raceFusionTable[i]={}),this.raceFusionTable[i][t]=a}}},{key:"parsePresets",value:function(){if(this.presetJson){var e,n=Object(h.a)(this.presetJson.presets);try{for(n.s();!(e=n.n()).done;){var t,i=e.value,a=[],r=Object(h.a)(i.demons);try{for(r.s();!(t=r.n()).done;){var s=t.value,o=this.getDemonByName(s);o&&a.push(o)}}catch(l){r.e(l)}finally{r.f()}var c=new g(i.caption,a);this.demonsPresets.push(c)}}catch(l){n.e(l)}finally{n.f()}}}},{key:"prepDemonIds",value:function(){this.demonAry=this.demonAry.sort((function(e,n){return e.lvl>n.lvl?1:-1}));var e,n=1,t=Object(h.a)(this.demonAry);try{for(t.s();!(e=t.n()).done;){var i=e.value;i.id=n,this.idMap[i.id]=i,this.nameMap[i.name]=i,n++}}catch(a){t.e(a)}finally{t.f()}}},{key:"prepRaceLvlInfo",value:function(){var e,n=Object(h.a)(this.demonAry);try{for(n.s();!(e=n.n()).done;){var t=e.value;this.raceLvlDemonMap[t.race]||(this.raceLvlDemonMap[t.race]={}),this.raceLvlDemonMap[t.race][t.lvl]=t}}catch(s){n.e(s)}finally{n.f()}var i,a=Object(h.a)(this.demonAry);try{for(a.s();!(i=a.n()).done;){var r=i.value;r.rank=this.getLvlTableForRace(r.race).indexOf(r.lvl)}}catch(s){a.e(s)}finally{a.f()}}},{key:"getLvlTableForRace",value:function(e){return this.raceLvlDemonMap[e]?Object.keys(this.raceLvlDemonMap[e]).map((function(e){return Number(e)})):[]}},{key:"getDemonFromRaceLvl",value:function(e,n){if(this.raceLvlDemonMap[e]&&this.raceLvlDemonMap[e][n])return this.raceLvlDemonMap[e][n]}},{key:"getFusionResultRace",value:function(e,n){if(this.raceFusionTable[e]&&this.raceFusionTable[e][n])return this.raceFusionTable[e][n]}},{key:"fuseDemonDiffRaceNoEle",value:function(e,n){var t=this.getFusionResultRace(e.race,n.race);if(t){var i=this.getLvlTableForRace(t);if(0!==i.length){for(var a=i.map((function(n){return 2*n-e.lvl-1})),r=0,s=0;s<a.length;s++)n.lvl>a[s]&&r++;r>=i.length&&(r=i.length-1);var o=i[r];return this.getDemonFromRaceLvl(t,o)}}}},{key:"fuseDemonSameRaceNoEle",value:function(e,n){var t=this.getFusionResultRace(e.race,n.race);if(t)return this.getDemonByName(t)}},{key:"fuseDemonWithElement",value:function(e,n){var t,i;if(e.race===p)t=e,i=n;else{if(n.race!==p)return this.fuseDemonSameRaceNoEle(e,n);t=n,i=e}var a=this.fusionChartJson.races.indexOf(i.race);if(!(a<0||a>=this.fusionChartJson.elementFusionTable.length)){var r=this.fusionChartJson.elementFusionTable[a][t.rank],s=this.getLvlTableForRace(i.race),o=i.rank+r;if(!(o<0||o>=s.length))return this.getDemonFromRaceLvl(i.race,s[o])}}}]),e}(),y=t(35),C=t(52),x=t(65),D=t(44),A=t(94),R=t.n(A),k=t(23),N=t.n(k);function F(e){var n=e.demonCompendium,t=e.ingredients,r=e.onRemoveIngredient,s=[{field:"name",headerName:"Demon",flex:1,resizable:!1},{field:"lvl",headerName:"Level",width:70,headerAlign:"center",resizable:!1,disableColumnMenu:!0},{field:"race",headerName:"Race",width:70,headerAlign:"center",resizable:!1,disableColumnMenu:!0},{field:"remove",headerName:" ",width:50,sortable:!1,disableColumnMenu:!0,renderCell:function(e){var n=e.value;return Object(i.jsx)(D.a,{"aria-label":"delete",onClick:o.bind(void 0,n),children:Object(i.jsx)(R.a,{className:N.a.removeDemonButtonIcon})})}}];function o(e){r&&r(e)}var c=Object.keys(t).map((function(e,t){var i=e,a=n.getDemonById(i);return{id:t,name:a.name,lvl:a.lvl,race:a.race,remove:a.id}})),l=Object(a.useRef)(null);return Object(a.useEffect)((function(){var e=l.current;e&&(e.firstElementChild.style.height="")}),[]),Object(i.jsx)("div",{style:{maxWidth:"500px"},ref:l,children:Object(i.jsx)(x.a,{rows:c,columns:s,disableSelectionOnClick:!0,autoHeight:!0,density:"compact",pageSize:25,rowsPerPageOptions:[25]})})}function B(e){return e.isFused()?Object(i.jsx)(r.a.Fragment,{children:e.demon.name}):Object(i.jsx)("span",{className:N.a.baseIngredientName,children:e.demon.name})}function _(e){var n=Object(i.jsx)(r.a.Fragment,{});if(e.ingredientA&&e.ingredientB){n=Object(i.jsxs)(r.a.Fragment,{children:[n,_(e.ingredientA)]}),n=Object(i.jsxs)(r.a.Fragment,{children:[n,_(e.ingredientB)]});var t=B(e.ingredientA),a=B(e.ingredientB),s=B(e);return Object(i.jsxs)(r.a.Fragment,{children:[n,Object(i.jsxs)("div",{className:N.a.recipeLine,children:[t," + ",a," = ",s]})]})}return n}function L(e){return Object(i.jsx)("div",{children:_(e.value)})}function I(e){return e.value.toBaseIngredientSearchString()}function S(e){for(var n=e.fusionResults,t=[{field:"name",headerName:"Demon",width:120},{field:"lvl",headerName:"Level",width:70,headerAlign:"center",resizable:!1,disableColumnMenu:!0},{field:"race",headerName:"Race",width:100,headerAlign:"center",resizable:!1}],r=b.statsName,s=0;s<r.length;s++)t.push({field:"stat"+s,headerName:r[s],width:60,headerAlign:"center",resizable:!1,disableColumnMenu:!0});t.push({field:"recipe",headerName:"Recipe",flex:1,renderCell:L,valueGetter:I});var o=[];for(var c in n)if(1!==Number(c))for(var l in n[c]){var u,d=Object(h.a)(n[c][l]);try{for(d.s();!(u=d.n()).done;){for(var m=u.value,f=m.demon,v={id:0,name:f.name,lvl:f.lvl,race:f.race,recipe:m},j=0;j<r.length;j++)v["stat"+j]=f.stats[j];o.push(v)}}catch(C){d.e(C)}finally{d.f()}}o.sort((function(e,n){return n.lvl-e.lvl}));for(var g=1,p=0,O=o;p<O.length;p++){O[p].id=g,g++}var y=Object(a.useRef)(null);return Object(a.useEffect)((function(){var e=y.current;if(e){var n=e.querySelector("div");n.style.height="",n.style.width=""}}),[]),Object(i.jsx)(x.a,{rows:o,rowHeight:75,className:N.a.fusionResultsTable,columns:t,disableSelectionOnClick:!0,autoHeight:!0,rowsPerPageOptions:[10],density:"compact"})}var T=t(107),M=t(182),w=t(95),J=t.n(w);function P(e){var n=e.demonCompendium,t=e.onAddDemon,a=Object(i.jsx)(r.a.Fragment,{});return n.getDemonPresets().length>0&&(a=Object(i.jsxs)(r.a.Fragment,{children:[Object(i.jsx)("p",{children:"Add from presets"}),Object(i.jsx)(z,{demonCompendium:n,onAddDemon:t})]})),Object(i.jsxs)("div",{className:N.a.demonAdderContainer,children:[Object(i.jsx)("p",{children:"Add by searching"}),Object(i.jsx)(E,{demonCompendium:n,onAddDemon:t}),Object(i.jsx)("p",{children:"Add by entering level range"}),Object(i.jsx)(H,{demonCompendium:n,onAddDemon:t}),a]})}function E(e){var n=e.demonCompendium,t=e.onAddDemon,r=Object(a.useState)(null),s=Object(l.a)(r,2),o=s[0],c=s[1],u=n.getDemonArray();function d(){o&&(t([o]),c(null))}return Object(i.jsxs)("div",{className:N.a.subAdderContainer,children:[Object(i.jsx)(M.a,{value:o,options:u,onChange:function(e,n){c(n)},onKeyPress:function(e){"Enter"===e.key&&d()},getOptionLabel:function(e){return e.name},getOptionSelected:function(e,n){return e.id===n.id},style:{width:300},autoHighlight:!0,autoSelect:!0,renderInput:function(e){return Object(i.jsx)(T.a,Object(y.a)(Object(y.a)({},e),{},{label:"Enter demon name",variant:"outlined"}))}}),Object(i.jsx)(W,{onClick:function(){d()}})]})}function H(e){var n=e.demonCompendium,t=e.onAddDemon,r=Object(a.useState)(1),s=Object(l.a)(r,2),o=s[0],c=s[1],u=Object(a.useState)(99),d=Object(l.a)(u,2),m=d[0],f=d[1];function v(e){var n=e.key;"-"!==n&&"+"!==n&&"."!==n||(e.preventDefault(),e.stopPropagation())}function b(e,n){var t=n.target.value,i=Number(t);(""===t||i>=1&&i<=99)&&e(n.target.value)}return Object(i.jsxs)("div",{className:N.a.subAdderContainer,children:[Object(i.jsxs)("div",{className:N.a.lvlFieldsContainer,children:[Object(i.jsx)(T.a,{label:"Min Lv",style:{width:"147px"},type:"number",InputLabelProps:{shrink:!0},variant:"outlined",value:o,onChange:b.bind(void 0,c),onKeyPress:v}),Object(i.jsx)(T.a,{label:"Max Lv",style:{width:"147px"},type:"number",InputLabelProps:{shrink:!0},variant:"outlined",value:m,onKeyPress:v,onChange:b.bind(void 0,f)})]}),Object(i.jsx)(W,{onClick:function(){var e,i=[],a=Object(h.a)(n.getDemonArray());try{for(a.s();!(e=a.n()).done;){var r=e.value;r.lvl>=o&&r.lvl<=m&&i.push(r)}}catch(s){a.e(s)}finally{a.f()}t(i)}})]})}function z(e){var n,t=e.demonCompendium,r=e.onAddDemon,s=Object(a.useState)(null),o=Object(l.a)(s,2),c=o[0],u=o[1],d=[],m=1,f=Object(h.a)(t.getDemonPresets());try{for(f.s();!(n=f.n()).done;){var v=n.value;d.push({id:m,preset:v}),m++}}catch(j){f.e(j)}finally{f.f()}function b(){c&&(r(c.preset.demons),u(null))}return Object(i.jsxs)("div",{className:N.a.subAdderContainer,children:[Object(i.jsx)(M.a,{value:c,options:d,onChange:function(e,n){u(n)},onKeyPress:function(e){"Enter"===e.key&&b()},getOptionLabel:function(e){return e.preset.caption},getOptionSelected:function(e,n){return e.id===n.id},style:{width:300},autoHighlight:!0,autoSelect:!0,renderInput:function(e){return Object(i.jsx)(T.a,Object(y.a)(Object(y.a)({},e),{},{label:"Select a preset",variant:"outlined"}))}}),Object(i.jsx)(W,{onClick:function(){b()}})]})}function W(e){var n=e.onClick;return Object(i.jsxs)(C.a,{variant:"outlined",onClick:n,className:N.a.addDemonButton,children:[Object(i.jsx)(J.a,{}),"Add"]})}var G=t(97),K=t.n(G),q=t(96),Q=t.n(q),V=t(51),X=t.n(V);var Y=function(e){var n=e.demonCompendium,t=Object(a.useState)({}),r=Object(l.a)(t,2),s=r[0],o=r[1],c=Object(a.useState)({}),u=Object(l.a)(c,2),d=u[0],m=u[1],f=Object(a.useState)(1),v=Object(l.a)(f,2),b=v[0],g=v[1],p=Object(a.useRef)(null);return Object(i.jsxs)("div",{className:X.a.fusionRecommender,children:[Object(i.jsx)("h2",{children:"Add demons to use as fusion ingredients"}),Object(i.jsxs)("div",{className:X.a.addDemonsAndCalcResetButtonContainer,children:[Object(i.jsx)(P,{demonCompendium:n,onAddDemon:function(e){var n,t=Object(y.a)({},s),i=Object(h.a)(e);try{for(i.s();!(n=i.n()).done;){t[n.value.id]=!0}}catch(a){i.e(a)}finally{i.f()}o(t)}},b),Object(i.jsxs)("div",{className:X.a.calcResetButtonContainer,children:[Object(i.jsxs)(C.a,{className:X.a.calculateButton,variant:"outlined",onClick:function(){for(var e={},t=1;t<=3;t++)e[t]={};for(var i in s){var a=n.getDemonById(Number(i));if(a){var r=new j(a);e[1][a.name]||(e[1][a.name]=[]),e[1][a.name].push(r)}}for(var o=2;o<=3;o++)for(var c=o-1;c>=o/2;c--){var l=o-c,u={};for(var d in e[c])if(0!==e[c][d].length){var f=e[c][d][0].demon;for(var v in e[l])if(0!==e[l][v].length){var b=e[l][v][0].demon;if(!u[b.id]){var g=n.fuseDemons(f,b);if(g){for(var O=!1,y=o-1;y>=1;y--)if(e[y][g.name]){O=!0;break}if(!O&&(3!==o||!(f.lvl>g.lvl||b.lvl>g.lvl))){var C,x=Object(h.a)(e[c][d]);try{for(x.s();!(C=x.n()).done;){var D,A=C.value,R=Object(h.a)(e[l][v]);try{for(R.s();!(D=R.n()).done;){var k=D.value,N=new j(g,A,k);e[o][g.name]||(e[o][g.name]=[]),e[o][g.name].push(N)}}catch(L){R.e(L)}finally{R.f()}}}catch(L){x.e(L)}finally{x.f()}}}}}u[f.id]=!0}}for(var F in e)if(1!==Number(F))for(var B in e[F]){var _=e[F][B].filter((function(e){return!e.isWeakerThanIngredients()}));e[F][B]=_}m(e),setTimeout((function(){null!=p.current&&p.current.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}))},disabled:0===Object.keys(s).length,children:[Object(i.jsx)(Q.a,{}),"Calculate"]}),Object(i.jsxs)(C.a,{className:X.a.resetButton,variant:"outlined",onClick:function(){o({}),m({}),g((b+1)%2)},children:[Object(i.jsx)(K.a,{}),"Reset"]})]})]}),Object(i.jsx)("h2",{children:"Fusion Ingredients"}),Object(i.jsx)(F,{demonCompendium:n,ingredients:s,onRemoveIngredient:function(e){var n=Object(y.a)({},s);delete n[e],o(n)}}),Object(i.jsx)("h2",{ref:p,children:"Results"}),Object(i.jsx)(S,{demonCompendium:n,fusionResults:d})]})},U=(t(128),Object(u.a)({palette:{type:"dark"},typography:{fontFamily:"sans-serif",fontSize:14}}));function Z(){var e=Object(a.useState)(void 0),n=Object(l.a)(e,2),s=n[0],o=n[1];Object(a.useEffect)((function(){s||function(e){var n=t.e(4).then(t.t.bind(null,185,3)).then((function(e){return e.default})),i=t.e(5).then(t.t.bind(null,186,3)).then((function(e){return e.default})),a=t.e(6).then(t.t.bind(null,187,3)).then((function(e){return e.default}));Promise.all([n,i,a]).then((function(n){var t=new O(n[0],n[1],n[2]);e(t)}))}(o)}),[s]);var c=s?Object(i.jsx)(Y,{demonCompendium:s}):Object(i.jsx)(r.a.Fragment,{});return Object(i.jsxs)(d.a,{theme:U,children:[Object(i.jsx)(m.a,{}),Object(i.jsxs)("div",{className:"myApp",children:[Object(i.jsx)("header",{className:"App-header",children:Object(i.jsx)("h1",{children:"Megami Tensei Fusion Recommender"})}),c]})]})}o.a.render(Object(i.jsx)(r.a.StrictMode,{children:Object(i.jsx)(Z,{})}),document.getElementById("root")),c()},23:function(e,n,t){e.exports={demonAdderContainer:"ui-components_demonAdderContainer__2j3Dm",subAdderContainer:"ui-components_subAdderContainer__wG2As",lvlFieldsContainer:"ui-components_lvlFieldsContainer__1OXHc",addDemonButton:"ui-components_addDemonButton__1BBcP",removeDemonButtonIcon:"ui-components_removeDemonButtonIcon__2ga3t",fusionResultsTable:"ui-components_fusionResultsTable__2Hl-s",baseIngredientName:"ui-components_baseIngredientName__18Eu_",recipeLine:"ui-components_recipeLine__12QIM"}},51:function(e,n,t){e.exports={fusionRecommender:"fusion-recommender_fusionRecommender__zW_X6",addDemonsAndCalcResetButtonContainer:"fusion-recommender_addDemonsAndCalcResetButtonContainer__2ixcY",calcResetButtonContainer:"fusion-recommender_calcResetButtonContainer__2ApJ-",calculateButton:"fusion-recommender_calculateButton__31QNj",shining:"fusion-recommender_shining__1og21",resetButton:"fusion-recommender_resetButton__3V_j0"}}},[[129,1,2]]]);
//# sourceMappingURL=main.fe2c0a3f.chunk.js.map